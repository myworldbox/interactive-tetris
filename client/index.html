<!DOCTYPE html>
<html>

<head>
  <title>COMP4021 Project</title>
  <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Play" />
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Press+Start+2P" />
  <link
    href="https://fonts.googleapis.com/css2?family=Bungee+Spice&family=Montserrat&family=Nabla&family=Press+Start+2P&display=swap"
    rel="stylesheet" />
  <link href="./src/style/style.css" rel="stylesheet" />
  <video autoplay muted loop id="bgVideo">
    <source src="./src/video/tetris-bg.mp4" type="video/mp4" />
  </video>
</head>

<body>
  <div class="login-page">
    <div class="login-wrap">
      <div class="login-html">
        <img id="tetris" src="./src/photo/tetris-logo.png" alt="TETRIS" />
        <div id="headings">
          <h1>Madly Tetris</h1>
        </div>

        <hr />
        <div class="left">
          <input id="tab-1" type="radio" name="tab" class="sign-in" checked /><label for="tab-1" class="tab">Sign
            In</label>
          <input id="tab-2" type="radio" name="tab" class="sign-up" /><label for="tab-2" class="tab">Sign Up</label>
          <div class="login-form">
            <div class="sign-in-htm">
              <form id="sign-in-form">
                <div class="group">
                  <label for="user" class="label">Username</label>
                  <input id="sign-in-user" type="text" class="input" />
                </div>
                <div class="group">
                  <label for="pass" class="label">Password</label>
                  <input id="sign-in-pass" type="password" class="input" data-type="password" />
                </div>

                <div class="group">
                  <input type="submit" class="button" value="Submit" />
                </div>

                <div id="sign-in-message" style="color: red" class="warning center"></div>
              </form>
            </div>
            <div class="sign-up-htm">
              <form id="sign-up-form">
                <div class="group">
                  <label for="user" class="label">Username</label>
                  <input id="sign-up-user" type="text" class="input" />
                </div>
                <div class="group">
                  <label for="name" class="label">Display Name</label>
                  <input id="sign-up-name" type="text" class="input" />
                </div>
                <div class="group">
                  <label for="pass" class="label">Password</label>
                  <input id="sign-up-pass" type="password" class="input" data-type="password" />
                </div>
                <div class="group">
                  <input type="submit" class="button" value="Submit" />
                </div>

                <div id="register-message" style="color: red" class="warning center"></div>
              </form>
            </div>
          </div>
        </div>

        <div class="right">
          <p class="DESINS">Gameplay:</p>
          <p style="font-size: 16px">This is a typical Tetris Game which you get points from clearing a Row.
          <br>However, your component will be punlished with speeding up the block while you cleared a Row.
          <br>Get Ready For You Eye Speed and Hand Speed!!!!
          </p>
          <hr />
          <br />
          <p class="DESINS">Instruction:</p>
          <p style="font-size: 16px">Maximum Time: 3 Minutes</p>
          
          <ul style="list-style: none; padding: 0;">
            <li>Left: Left Arrow Key</li>
            <li>Right: Right Arrow Key</li>
            <li>Speeding Down: Down Arrow Key</li>
            <li>Clockwise Rotation: "R" Key</li>
            <li style="color: #ff0000; position: relative;" class="Cheat-box">
              <span class="Cheat-text" style="padding: 0">Stop Falling: Space Bar</span>
              <span class="cover"></span>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <script src="./src/action/registration.js"></script>
  <script src="./src/action/sprite.js"></script>
  <script src="/socket.io/socket.io.min.js"></script>
  <script src="./src/action/game.js"></script>
  <script src="./src/action/socket.js"></script>
  <script src="./src/action/authentication.js"></script>
  
  
  <script>
    $(document).ready(function () {
      Game.initialize();
      AnimatedCharacter.init();

      $("#sign-in-form").on("submit", (e) => {
        
        e.preventDefault();

        // Get the input fields
        const username = $("#sign-in-user").val().trim();
        const password = $("#sign-in-pass").val().trim();

        // Send a signin request
        Authentication.signin(
          username,
          password,
          () => {
            $(".login-page").css("display", "none");
            $("#bgVideo").css("display", "none");
            $(".game-page").css("display", "block");
            Socket.connect();
          },
          (error) => {
            $("#sign-in-message").text(error);
          }
        );
      });

      // Registration
      $("#sign-up-form").on("submit", (e) => {
        
        e.preventDefault();

        // Input data
        const username = $("#sign-up-user").val().trim();
        const name = $("#sign-up-name").val().trim();
        const password = $("#sign-up-pass").val().trim();

        // Register request
        Registration.register(
          username,
          name,
          password,
          () => {
            $("#sign-up-form").get(0).reset();
            $("#register-message").text("Successfully Register. Please Sign In.");
          },
          (error) => {
            $("#register-message").text(error);
          }
        );
      });

      Authentication.validate(
        () => {
          $(".login-page").css("display", "none");
          $("#bgVideo").css("display", "none");
          $(".game-page").css("display", "block");
          Socket.connect();
        },
        () => { }
      );

      $("#start-button").on("click", () => {
        Socket.join();
        $("#start-button").prop("disabled", true);
      });

      $("#restart-btn").on("click", () => {
        window.location.reload();
      });

    });
  </script>

  <div id="waitingModal" class="modal">
    <div class="modal-content" id="waitingModals">
      Another player is required to start...
    </div>
  </div>

  <div class="game-page">

    <div class="board">
      <div class="board-left">

        <div id="name-left" style="display: none;"></div>
        <div class="score-grid gradient-border">
          <h3 class="game-h3">
            <div>User:<div id="username-left"></div></div>
            
            <span id="score-left">Score: 0</span>
          </h3>
        </div>

        <div class="round-time-bar" id="round-time-bar-left" data-style="smooth">
          <div></div>
        </div>
        <div class = "container">
          <div class="lines-grid">
            <h4 class="game-h4">Lines: <span id="line-left">0</span></h4>
          </div>
        </div>
        <div class="container">
          <div class="mini-grid current-mini">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>
          
        </div>

        <div class="container">
          <div class="grid current gradient-border">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
          </div>
        </div>
      </div>

      <div style="display: flex; flex-direction: column; justify-content: center; align-items: center;">
        
        <button class="custom-btn btn-start" id="start-button">Let's Go</button>
        <h1 class="game-h1">Madly</h1>
        <h1 class = "game-h1">Tetris</h1>
        <h1 class="game-h4">Time:<span class="timer">180</span><span> seconds</span></h1>    
        <canvas width="500" height="120"></canvas>    
      </div>

      <div class="board-right">
        <div class="score-grid gradient-border">
          <div id="name-right" style="display: none"></div>
          <h3 class="game-h3">
            <div>USER:</div>
            <div id="username-right"></div>
            <span id="score-right">Score: 0</span>
          </h3>
        </div>

        <div class="round-time-bar" id="round-time-bar-right" data-style="smooth">
          <div></div>
        </div>
        <div class="container">
          <div class="lines-grid">
            <h4 class="game-h4">Lines: <span id="line-right">0</span></h4>
          </div>
        </div>
        <div class="container">
          <div class="mini-grid opponent-mini">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>
          
        </div>

        <div class="container">
          <div class="grid opponent gradient-border">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
            <div class="taken"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="gameover-page">
    <div class="card">
      <section class="card-info card-section">
        <section class="user row">
          <h1 class="user-header" id="user" style="border: #00e1ff;"></h1>
        </section>
        <h1>VS</h1>

        <div>
          <h1 id="opponent" style="border: #00e1ff;"></h1>
        </div>
        <hr />
        <div>
          <h1 id="result"></h1>
        </div>

        <section class="statistics">
          <article class="statistic">
            <h4 class="statistic-title">Cleared</h4>
            <h3 class="statistic-value" id="lines"></h3>
            <h4 class="statistic-title">Lines</h4>
          </article>
        </section>

        <div class="dial">
          <h1 class="dial-title">SCORE</h1>
          <h2 class="dial-value" id="score"></h2>
        </div>
        <div style="font-size: 30px">
          <span style="color: #ff0000">T</span>
          <span style="color: #f7a102">E</span>
          <span style="color: #f5f82a">T</span>
          <span style="color: #73fc24">R</span>
          <span style="color: #00e1ff">I</span>
          <span style="color: #ea00ff">S</span>
        </div>
      </section>

      <section class="card-details card-section">
        <h1 class="menu" style="color: black">Best Players:</h1>

        <dl class="leaderboard">
          <dt>
            <article class="progress" id="firstleader-bar" style="width: 100%"></article>
          </dt>
          <dd>
            <div class="leaderboard-name" id="firstleader-name"></div>
            <div class="leaderboard-value" id="firstleader-score"></div>
          </dd>
          <dt>
            <article class="progress" id="secondleader-bar"></article>
          </dt>
          <dd>
            <div class="leaderboard-name" id="secondleader-name"></div>
            <div class="leaderboard-value" id="secondleader-score"></div>
          </dd>
          <dt>
            <article class="progress" id="thirdleader-bar"></article>
          </dt>
          <dd>
            <div class="leaderboard-name" id="thirdleader-name"></div>
            <div class="leaderboard-value" id="thirdleader-score"></div>
          </dd>
          <dt>
            <article class="progress" id="fourthleader-bar"></article>
          </dt>
          <dd>
            <div class="leaderboard-name" id="fourthleader-name"></div>
            <div class="leaderboard-value" id="fourthleader-score"></div>
          </dd>
          <dt>
            <article class="progress" id="fifthleader-bar"></article>
          </dt>
          <dd>
            <div class="leaderboard-name" id="fifthleader-name"></div>
            <div class="leaderboard-value" id="fifthleader-score"></div>
          </dd>
        </dl>

        <button class="custom-btn btn-start" id="restart-btn">Restart</button>
      </section>
    </div>
  </div>

  <script src="./src/action/gameFinish.js"></script>
</body>

</html>